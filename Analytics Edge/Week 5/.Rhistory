user_dt=user_info1$dt[i]
print(user_uid)
print (user_dt)
temp=filter(user_gs1,uid==user_uid,dt<=user_dt+7)%>%group_by(uid)%>%summarise(milestone=tail(milestone,1))
#print(temp)
#final$uid=user_uid
#final$milestone=temp$milestone
final=rbind(final,temp)
}
for(i in seq(100)){
user_uid=user_info1$uid[i]
user_dt=user_info1$dt[i]
print(user_uid)
print (user_dt)
#temp=filter(user_gs1,uid==user_uid,dt<=user_dt+7)%>%group_by(uid)%>%summarise(milestone=tail(milestone,1))
try(filter(user_gs1,uid==user_uid,dt<=user_dt+7)%>%group_by(uid)%>%summarise(milestone=tail(milestone,1)),silent = TRUE)
#print(temp)
#final$uid=user_uid
#final$milestone=temp$milestone
final=rbind(final,temp)
}
View(final)
try(1/0)
try('1'/0)
try('1'/0,silent=TRUE)
final=data.frame(uid=numeric(),milestone=character())
for(i in seq(10)){
user_uid=user_info1$uid[i]
user_dt=user_info1$dt[i]
print(user_uid)
print (user_dt)
temp=filter(user_gs1,uid==user_uid,dt<=user_dt+7)%>%group_by(uid)%>%summarise(milestone=tail(milestone,1))
#try(filter(user_gs1,uid==user_uid,dt<=user_dt+7)%>%group_by(uid)%>%summarise(milestone=tail(milestone,1)),silent = TRUE)
#print(temp)
#final$uid=user_uid
#final$milestone=temp$milestone
final=rbind(final,temp)
}
final=data.frame(uid=numeric(),milestone=character())
for(i in seq(10)){
user_uid=user_info1$uid[i]
user_dt=user_info1$dt[i]
#print(user_uid)
print (user_dt)
print (user_dt+7)
temp=filter(user_gs1,uid==user_uid,dt<=user_dt+7)%>%group_by(uid)%>%summarise(milestone=tail(milestone,1))
#try(filter(user_gs1,uid==user_uid,dt<=user_dt+7)%>%group_by(uid)%>%summarise(milestone=tail(milestone,1)),silent = TRUE)
#print(temp)
#final$uid=user_uid
#final$milestone=temp$milestone
final=rbind(final,temp)
}
final=data.frame(uid=numeric(),milestone=character())
for(i in seq(10)){
user_uid=user_info1$uid[i]
user_dt=user_info1$dt[i]
#print(user_uid)
print (user_dt)
print (user_dt+7)
tryCatch({rbind(final,filter(user_gs1,uid==user_uid,dt<=user_dt+7)%>%group_by(uid)%>%summarise(milestone=tail(milestone,1)))},error=function(e){})
#try(filter(user_gs1,uid==user_uid,dt<=user_dt+7)%>%group_by(uid)%>%summarise(milestone=tail(milestone,1)),silent = TRUE)
#print(temp)
#final$uid=user_uid
#final$milestone=temp$milestone
#final=rbind(final,temp)
}
final=data.frame(uid=numeric(),milestone=character())
for(i in seq(100)){
user_uid=user_info1$uid[i]
user_dt=user_info1$dt[i]
#print(user_uid)
print (user_dt)
print (user_dt+7)
tryCatch({rbind(final,filter(user_gs1,uid==user_uid,dt<=user_dt+7)%>%group_by(uid)%>%summarise(milestone=tail(milestone,1)))},error=function(e){})
#try(filter(user_gs1,uid==user_uid,dt<=user_dt+7)%>%group_by(uid)%>%summarise(milestone=tail(milestone,1)),silent = TRUE)
#print(temp)
#final$uid=user_uid
#final$milestone=temp$milestone
#final=rbind(final,temp)
}
pwd
rm(lsit=ls())
rm(list=ls())
load("~/Documents/Analytics Edge/Week 4/assignment/.RData")
library("rpart", lib.loc="/Library/Frameworks/R.framework/Versions/3.1/Resources/library")
library("rpart.plot", lib.loc="/Library/Frameworks/R.framework/Versions/3.1/Resources/library")
prp(model1)
pred=predict(model1,newdata = test,type="class")
pred
pred=predict(model1,newdata = test)
pred
as.numeric(performance(pred_roc, "auc")@y.values)
library(ROCR)
pred_roc=predict(model1,newdata = test)
as.numeric(performance(pred_roc, "auc")@y.values)
rocrpred=prediction(pred[,2],test$over50k)
as.numeric(performance(rocrpred,"auc")@y.values)
set.seed(1)
trainSmall = train[sample(nrow(train), 2000), ]
library("randomForest", lib.loc="/Library/Frameworks/R.framework/Versions/3.1/Resources/library")
View(trainSmall)
rf=randomForest(over50k~.,data=trainSmall)
predict(rf,test)
pred_rf=predict(rf,test)
pred_rf
pred_rf=predict(rf,newdata=test)
table(test$over50k,pred_rf)
10666/12791
vu = varUsed(rf, count=TRUE)
vusorted = sort(vu, decreasing = FALSE, index.return = TRUE)
dotchart(vusorted$x, names(MODEL$forest$xlevels[vusorted$ix]))
dotchart(vusorted$x, names(rf$forest$xlevels[vusorted$ix]))
varImpPlot9rf
varImpPlot(rf)
set.seed(2)
library("caret", lib.loc="/Library/Frameworks/R.framework/Versions/3.1/Resources/library")
cartGrid = expand.grid( .cp = seq(0.002,0.1,0.002))
numFolds = trainControl( method = "cv", number = 10 )
train(over50k~.,data=train,method="rpart",trControl=numFolds,tuneGrid = cartGrid)
final=rparrt(over50k~.,data=train,method="class",cp=0.002)
final=rpart(over50k~.,data=train,method="class",cp=0.002)
predict(final,test)
table(test$over50k,predict(final,test,type="class"))
11016/12791
prp(final)
rm(list=ls())
temp=c(-5,-4,-3,-2,1,7,10,11,17,18)
median(temp)
temp1=c(-11,-5,-3,-3,-1,-1,-1,2,3,5,12)
median(temp1)
milestone <- read.csv("~/Desktop/milestone.csv")
View(milestone)
completed_attempt <- read.csv("~/Desktop/completed_attempt.csv")
View(completed_attempt)
total_attempt <- read.csv("~/Desktop/total_attempt.csv")
View(total_attempt)
final=merge(completed_attempt,total_attempt,by="milestone")
final1=merge(final,milestone,by.x = "milestone",by.y = "milestone_id")
View(final1)
library(dplyr)
final2=mutate(final1,conv=total2/total1)%>%arrange(desc(conv))
View(final2)
colnames(final2)=c("milestone","cleared","attempts","conversion")
View(final2)
final3=arrange(final2,asc(milestone))
final3=arrange(final2,milestone)
View(final3)
sum(final3$attempts)/sum(final3$cleared)
sum(final3$attempts[1:100])/sum(final3$cleared[1:100])
sum(final3$attempts[1:100])/sum(final3$cleared[1:100])
sum(final3$attempts[1:10])/sum(final3$cleared[1:10])
write.csv(final3,"pass nahi hoga.csv",row.names=F)
data <- read.csv("~/data.csv")
View(data)
View(data)
final4=merge(final3,data,by = "milestone")
View(final4)
final4$Distinct.count.of.uid=NULL
View(final4)
colnames(final4)[,5]="total_users"
colnames(final4)[,c(5)]="total_users"
colnames(final4)
colnames(final4)[5]="total_users"
View(final4)
write.csv(final4,"karthik.csv",row.names=F)
str(final4)
final4=mutate(final4,total_users=int(total_users))
final4=mutate(final4,total_users=as.integer(total_users))
str(final4)
final4=merge(final3,data,by = "milestone")
colnames(final4)[5]="total_users"
View(final4)
final4$total_users=NULL
colnames(final4)[5]="total_users"
View(final4)
final5=mutate(final4,total_users=as.numeric(as.character(total_users)))
View(final5)
final5=mutate(final4,total_users=as.numeric(levels(total_users))[total_users])
View(final4)
final5=mutate(final4,total_users=as.numeric(gsub(",","",total_users)))
View(final5)
write.csv(final5,"karthik1.csv",row.names=F)
final5$conversion=NULL
View(final5)
284664
filter(final5,cleared==284664)
442275/284664
final6=mutate(final5,temp=attempts/cleared)
View(final6)
filter(final6,temp>10)
write.csv(final6,"karthik2.csv",row.names=F)
filter(final6,temp>10)
plot(final6$temp)
rm(list=ls())
user_info <- read.csv("~/Desktop/user_info.csv")
View(user_info)
credits <- read.csv("~/Desktop/credits.csv", stringsAsFactors=FALSE)
View(credits)
user_info <- read.csv("~/Desktop/user_info.csv",stringsAsFactors=FALSE)
View(user_info)
user_info1=filter(user_info,uid %in% credits$uid)
str(user_info)
str(credits)
user_info$uid %in% credits$uid
user_info1=user_info[user_info$uid %in% credits$uid,]
View(user_info1)
row.names(user_info1)=NULL
View(user_info1)
str(credits)
library("sqldf", lib.loc="/Library/Frameworks/R.framework/Versions/3.1/Resources/library")
View(credits)
credits1=sqldf("select uid,date(paymenttime) as dt_pay,amount from credits")
View(credits1)
str(user_info1)
library("lubridate", lib.loc="/Library/Frameworks/R.framework/Versions/3.1/Resources/library")
user_info1=mutate(user_info1,dt_start=ymd(dt_start))
library("dplyr", lib.loc="/Library/Frameworks/R.framework/Versions/3.1/Resources/library")
user_info2=mutate(user_info1,dt_start=ymd(dt_start))
temp=user_info2$dt_start[1:10]
temp
temp+10
temp+days(10)
temp=user_info2$dt_start[1:10]
temp
temp+days(10)
str(user_info2)
str(credits1)
mutate(credits1,dt_pay=ymd(dt_pay))
credits1=mutate(credits1,dt_pay=ymd(dt_pay))
uid=c()
amount=c()
for (i in seq(user_info1)){
temp_uid=user_info2$uid[i]
start_date=user_info2$dt_start[i]
uid=c(uid,temp_uid)
temp_data=filter(credits1,uid==temp_uid,dt_pay<start_date+days(28))%>%group_by(uid)%>%summarise(total=sum(amount))
amount=c(amount,temp_data$total)
}
uid=c()
amount=c()
for (i in seq(user_info1)){
temp_uid=user_info2$uid[i]
start_date=user_info2$dt_start[i]
uid=c(uid,temp_uid)
temp_data=filter(credits1,uid==temp_uid,dt_pay<start_date+days(28))%>%group_by(uid)%>%summarise(total=sum(amount))
amount=c(amount,temp_data$total)
}
uid=c()
amount=c()
for (i in seq(user_info1)){
temp_uid=user_info2$uid[i]
start_date=user_info2$dt_start[i]
uid=c(uid,temp_uid)
temp_data=filter(credits1,uid==temp_uid,dt_pay<start_date+days(28))%>%group_by(uid)%>%summarise(total=sum(amount))
amount=c(amount,temp_data$total)
}
unique(user_info2$uid)
sum(unique(user_info2$uid)==unique(credits1$uid))
unique(user_info2$uid)==unique(credits1$uid)
which(unique(user_info2$uid)==unique(credits1$uid))
uid=c()
amount=c()
for (i in c(217,466)){
temp_uid=user_info2$uid[i]
start_date=user_info2$dt_start[i]
uid=c(uid,temp_uid)
temp_data=filter(credits1,uid==temp_uid,dt_pay<start_date+days(28))%>%group_by(uid)%>%summarise(total=sum(amount))
amount=c(amount,temp_data$total)
}
temp_uid=user_info2$uid[217]
filter(credits1,uid==temp_uid,dt_pay<start_date+days(28))%>%group_by(uid)%>%summarise(total=sum(amount))
filter(credits1,uid==temp_uid)
sqldf(paste("select uid,sum(amount) as total from credits1 where uid="),temp_uid)
sqldf(paste("select uid,sum(amount) as total from credits1 where uid=",temp_uid))
filter(credits1,uid==temp_uid)%>%group_by(uid)%>%summarise(total=sum(amount))
filter(credits1,uid==temp_uid,,dt_pay<start_date+days(365))%>%group_by(uid)%>%summarise(total=sum(amount))
filter(credits1,uid==temp_uid,dt_pay<start_date+days(365))%>%group_by(uid)%>%summarise(total=sum(amount))
temp_uid=user_info2$uid[466]
filter(credits1,uid==temp_uid,dt_pay<start_date+days(365))%>%group_by(uid)%>%summarise(total=sum(amount))
uid=c()
amount=c()
for (i in seq(user_info)){
if (user_info$uid[i] %in% unique(credits$uid)){
temp_uid=user_info$uid[i]
start_date=user_info$dt_start[i]
uid=c(uid,temp_uid)
temp_data=filter(credits1,uid==temp_uid,dt_pay<start_date+days(365))%>%group_by(uid)%>%summarise(total=sum(amount))
amount=c(amount,temp_data$total)
}
}
uid=c()
amount=c()
for (i in seq(user_info)){
if (user_info$uid[i] %in% unique(credits$uid)){
print (1)
temp_uid=user_info$uid[i]
start_date=user_info$dt_start[i]
uid=c(uid,temp_uid)
temp_data=filter(credits1,uid==temp_uid,dt_pay<start_date+days(365))%>%group_by(uid)%>%summarise(total=sum(amount))
amount=c(amount,temp_data$total)
}
}
uid=c()
amount=c()
for (i in seq(user_info)){
print (1)
if (user_info$uid[i] %in% unique(credits$uid)){
print (1)
temp_uid=user_info$uid[i]
start_date=user_info$dt_start[i]
uid=c(uid,temp_uid)
temp_data=filter(credits1,uid==temp_uid,dt_pay<start_date+days(365))%>%group_by(uid)%>%summarise(total=sum(amount))
amount=c(amount,temp_data$total)
}
}
uid=c()
amount=c()
for (i in seq(user_info$uid)){
print (1)
if (user_info$uid[i] %in% unique(credits$uid)){
print (1)
temp_uid=user_info$uid[i]
start_date=user_info$dt_start[i]
uid=c(uid,temp_uid)
temp_data=filter(credits1,uid==temp_uid,dt_pay<start_date+days(365))%>%group_by(uid)%>%summarise(total=sum(amount))
amount=c(amount,temp_data$total)
}
}
uid=c()
amount=c()
for (i in seq(user_info$uid)){
#print (1)
if (user_info$uid[i] %in% unique(credits$uid)){
print (1)
temp_uid=user_info$uid[i]
start_date=user_info$dt_start[i]
uid=c(uid,temp_uid)
temp_data=filter(credits1,uid==temp_uid,dt_pay<start_date+days(28))%>%group_by(uid)%>%summarise(total=sum(amount))
amount=c(amount,temp_data$total)
}
}
View(user_info)
mutate(user_info,dt_start=ymd(dt_start))
uid=c()
amount=c()
for (i in seq(user_info$uid)){
#print (1)
if (user_info$uid[i] %in% unique(credits$uid)){
print (1)
temp_uid=user_info$uid[i]
start_date=user_info$dt_start[i]
uid=c(uid,temp_uid)
temp_data=filter(credits1,uid==temp_uid,dt_pay<start_date+days(28))%>%group_by(uid)%>%summarise(total=sum(amount))
amount=c(amount,temp_data$total)
}
}
filter(credits1,uid==temp_uid,dt_pay<start_date+days(28))%>%group_by(uid)%>%summarise(total=sum(amount))
filter(credits1,uid==temp_uid,ymd(dt_pay)<ymd(start_date)+days(28))%>%group_by(uid)%>%summarise(total=sum(amount))
uid=c()
amount=c()
for (i in seq(user_info$uid)){
#print (1)
if (user_info$uid[i] %in% unique(credits$uid)){
print (1)
temp_uid=user_info$uid[i]
start_date=user_info$dt_start[i]
uid=c(uid,temp_uid)
temp_data=filter(credits1,uid==temp_uid,dt_pay<start_date+days(28))%>%group_by(uid)%>%summarise(total=sum(amount))
amount=c(amount,temp_data$total)
}
}
filter(credits1,uid==temp_uid,dt_pay<start_date+days(28))%>%group_by(uid)%>%summarise(total=sum(amount))
str(credits1)
start_date=ymd("2013-01-19")
filter(credits1,uid==temp_uid,dt_pay<start_date+days(28))%>%group_by(uid)%>%summarise(total=sum(amount))
filter(credits1,uid==temp_uid,dt_pay<start_date+days(365))%>%group_by(uid)%>%summarise(total=sum(amount))
uid=c()
amount=c()
for (i in seq(user_info$uid)){
#print (1)
if (user_info$uid[i] %in% unique(credits$uid)){
print (1)
temp_uid=user_info$uid[i]
start_date=user_info$dt_start[i]
uid=c(uid,temp_uid)
temp_data=filter(credits1,uid==temp_uid,as.Date(dt_pay)<as.Date(start_date+days(28))%>%group_by(uid)%>%summarise(total=sum(amount))
amount=c(amount,temp_data$total)
}
}
uid=c()
amount=c()
for (i in seq(user_info$uid)){
#print (1)
if (user_info$uid[i] %in% unique(credits$uid)){
print (1)
temp_uid=user_info$uid[i]
start_date=user_info$dt_start[i]
uid=c(uid,temp_uid)
temp_data=filter(credits1,uid==temp_uid,as.Date(dt_pay)<start_date+days(28))%>%group_by(uid)%>%summarise(total=sum(amount))
amount=c(amount,temp_data$total)
}
}
ymd("2013-01-19" + days(28))
ymd("2013-01-19") + days(28)
as.Date(ymd("2013-01-19") + days(28))
as.Date(ymd("2013-01-19") + days(28))<as.Date("2013-02-10")
filter(credits1,uid==temp_uid)
filter(credits1,uid==temp_uid,as.Date(dt_pay)<start_date+days(1000))
filter(credits1,uid==temp_uid,as.Date(dt_pay)<as.Date(start_date+days(1000)))
unique(credits1$uid)
which(user_info$uid %in% unique(credits1$uid))
temp=which(user_info$uid %in% unique(credits1$uid))
uid=c()
amount=c()
for (i in temp){
#print (1)
if (user_info$uid[i] %in% unique(credits$uid)){
print (1)
temp_uid=user_info$uid[i]
start_date=user_info$dt_start[i]
uid=c(uid,temp_uid)
temp_data=filter(credits1,uid==temp_uid)%>%group_by(uid)%>%summarise(total=sum(amount))
amount=c(amount,temp_data$total)
}
}
uid
amount
uid=c()
amount=c()
for (i in temp){
#print (1)
if (user_info$uid[i] %in% unique(credits$uid)){
print (1)
temp_uid=user_info$uid[i]
start_date=user_info$dt_start[i]
uid=c(uid,temp_uid)
temp_data=filter(credits1,uid==temp_uid,dt_pay<ymd(start_date)+days(28))%>%group_by(uid)%>%summarise(total=sum(amount))
amount=c(amount,temp_data$total)
}
}
group_by(uid)%>%summarise(first_pay=dt_pay[1])
group_by(credits1,uid)%>%summarise(first_pay=dt_pay[1])
filter(credits1,uid==5733463)
first_pay=group_by(credits1,uid)%>%summarise(first_pay=dt_pay[1])$first_pay
first_pay=group_by(credits1,uid)%>%summarise(first_pay=dt_pay[1])
first_pay=first_pay$first_pay
first_pay
uid=c()
amount=c()
for (i in temp){
#print (1)
if (user_info$uid[i] %in% unique(credits$uid)){
print (1)
temp_uid=user_info$uid[i]
start_date=user_info$dt_start[i]
if (start_date+days(28)>first_pay){
uid=c(uid,temp_uid)
temp_data=filter(credits1,uid==temp_uid,dt_pay<ymd(start_date)+days(28))%>%group_by(uid)%>%summarise(total=sum(amount))
amount=c(amount,temp_data$total)
}
}
}
uid=c()
total_time=c()
for (i in seq_along(user_info1$uid)){
temp_uid=user_info1$uid[i]
#temp_uid=i
#print (temp_uid)
temp_val=filter(user_gs1,uid==temp_uid)%>%group_by(uid)%>%summarise(total=sum(as.numeric(period_to_seconds(hms(timetaken)))))
uid=c(uid,user_info1$uid[i])
total_time=c(total_time,temp_val$total)
}
uid=c()
amount=c()
for (i in temp){
#print (1)
if (user_info$uid[i] %in% unique(credits$uid)){
print (1)
temp_uid=user_info$uid[i]
start_date=user_info$dt_start[i]
if (start_date+days(28)>first_pay){
uid=c(uid,temp_uid)
temp_data=filter(credits1,uid==temp_uid)%>%group_by(uid)%>%summarise(total=sum(amount))
amount=c(amount,temp_data$total)
}
}
}
uid=c()
amount=c()
for (i in temp){
#print (1)
if (user_info$uid[i] %in% unique(credits$uid)){
print (1)
temp_uid=user_info$uid[i]
start_date=user_info$dt_start[i]
uid=c(uid,temp_uid)
temp_data=filter(credits1,uid==temp_uid)%>%group_by(uid)%>%summarise(total=sum(amount))
amount=c(amount,temp_data$total)
}
}
temp=data.frame(uid,amount)
View(temp)
emails <- read.csv("~/Documents/Analytics Edge/Week 5/assignment/emails.csv", stringsAsFactors=FALSE)
View(emails)
corpus = Corpus(VectorSource(emails$text))
library("tm", lib.loc="/Library/Frameworks/R.framework/Versions/3.1/Resources/library")
corpus = Corpus(VectorSource(emails$text))
corpus = tm_map(corpus, tolower)
corpus = tm_map(corpus, PlainTextDocument)
corpus = tm_map(corpus, removePunctuation)
corpus = tm_map(corpus, removeWords, stopwords("english"))
setwd("~/Documents/Analytics Edge/Week 5")
