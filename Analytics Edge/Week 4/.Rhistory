total_user_installs=90000
as.data.frame(Cumulative.Rating,current_user_installs,total_user_installs)
data.frame(Cumulative.Rating,current_user_installs,total_user_installs)
predict(rfFit1,newdata=data.frame(Cumulative.Rating=4.3,current_user_installs=31000,total_user_installs=90000)
)
predict(rfFit1,newdata=data.frame(Cumulative.Rating=4.3,current_user_installs=40000,total_user_installs=90000))
predict(rfFit1,newdata=data.frame(Cumulative.Rating=4.3,current_user_installs=50000,total_user_installs=90000))
predict(rfFit1,newdata=data.frame(Cumulative.Rating=4.3,current_user_installs=35000,total_user_installs=90000))
predict(rfFit1,newdata=data.frame(Cumulative.Rating=4.3,current_user_installs=31000,total_user_installs=90000))
predict(rfFit1,newdata=data.frame(Cumulative.Rating=4.3,current_user_installs=31000,total_user_installs=100000))
predict(rfFit1,newdata=data.frame(Cumulative.Rating=4.9,current_user_installs=31000,total_user_installs=100000))
predict(rfFit1,newdata=data.frame(Cumulative.Rating=4.9,current_user_installs=310000,total_user_installs=100000))
predict(rfFit1,newdata=data.frame(Cumulative.Rating=4.9,current_user_installs=3100000,total_user_installs=100000))
lm(rank2$pred,rank2$current_user_installs)
lm(rank2$pred~rank2$current_user_installs)
f8=dbConnect(MySQL(),user="sudokuphp",password="successlist",host="192.168.1.123",dbname="f8sudokuquest")
nonf8=dbConnect(MySQL(),user="sudokuphp",password="successlist",host="192.168.1.123",dbname="nonf8sudokuquest")
query=dbSendQuery(f8,"select uid,country,source,starttime from user_info")
dataf8=fetch(query,n=-1)
query=dbSendQuery(nonf8,"select uid,country,source,starttime from user_info")
datanonf8=fetch(query,n=-1)
final=rbind(dataf8,datanonf8)
View(final)
dbWriteTable(nonf8,name = "user_info_combined",value = final)
write.csv(final,"combined_user_info.csv",row.names=F)
dbWriteTable(nonf8,name = "user_info_combined",value = final)
dbClearResult(dbListResults(nonf8)[[1]])
dbWriteTable(nonf8,name = "user_info_combined",value = final)
dbClearResult(dbListResults(f8)[[1]])
dbWriteTable(f8,name = "user_info_combined",value = final)
temp_venn <- read.csv("~/Desktop/temp_venn.csv")
View(temp_venn)
library(dplyr)
temp$device %like% 'ip'
grep('ip',temp$device)
grepl('ip',temp$device)
grepl('iph',temp$device)
grepl('ip',temp_venn$device)
grep('ip',temp_venn$device)
ios=as.numeric(grepl('ip',temp_venn$device))
desktop=as.numeric(grepl('desktop',temp_venn$device))
sum(desktop)
sequence=rep(0,29154)
sequence[ios]=1
sequence[desktop]=1
sequence=!sequence
sequence=as.numeric(sequence)
install.packages("limma")
library("devtools", lib.loc="/Library/Frameworks/R.framework/Versions/3.1/Resources/library")
install_url("http://master.bioconductor.org/packages/release/bioc/bin/macosx/mavericks/contrib/3.1/limma_3.22.7.tgz")
library("limma", lib.loc="/Library/Frameworks/R.framework/Versions/3.1/Resources/library")
final=cbind(desktop,ios,sequence)
final=data.frame(desktop,ios,sequence)
View(final)
cols<-c("Red", "Green", "Blue")
vennDiagram(vennCounts(final), circle.col=cols)
ios=as.numeric(grepl('$ip',temp_venn))
ios
ios=as.numeric(grepl('$ip',temp_venn$device))
ios
sum(ios)
ios=as.numeric(grepl('^ip',temp_venn$device))
sum(ios)
ios=as.numeric(grepl('ip',temp_venn$device))
sum(ios)
ios=as.numeric(grepl('iP',temp_venn$device))
sum(ios)
ios
ios=as.numeric(grepl('iP',temp_venn$device))
desktop=as.numeric(grepl('desktop',temp_venn$device))
filter(temp$device,!grepl('desktop',temp_venn$device),!grepl('iP',temp_venn$device))
temp_venn$device[ios]='ios'
View(temp_venn)
temp_venn <- read.csv("~/Desktop/temp_venn.csv")
View(temp_venn)
str(temp_venn)
temp=temp_venn
grepl('iP',temp$device)
as.numeric(grepl('iP',temp$device)0
as.numeric(grepl('iP',temp$device))
sum(as.numeric(grepl('iP',temp$device)))
sum(as.numeric(grepl('de',temp$device)))
local=dbConnect(MySQL(),user="root",password="",host="localhost",dbname="test")
user_gs <- read.csv("~/PycharmProjects/AI Project 1 /user_gs.csv")
View(user_gs)
dbWriteTable(local,name = "user_gs",value = user_gs)
library(dplyr)
user_gs=mutate(user_gs,lasttime=as.POSIXct('2015-3-3'))
View(user_gs)
dbWriteTable(local,name = "user_gs",value = user_gs)
pnorm(q = 5/3.2,mean = 0,sd = 1)
pnorm(q = -5/3.2,mean = 0,sd = 1)
0.93^7
1-0.93^7
library(ggplot2)
final <- read.csv("~/analytics/final_rank_data.csv")
View(final)
qplot(ranking,data=final)
qplot(Ranking,data=final)
qplot(Date,Ranking,data=final)
qplot(Date,Ranking,data=final)
library(dplyr)
View(final)
arrange(final,Date)
arrange(final,Date,desc)
arrange(final,desc(Date))
str(final)
View(final)
temp=mutate(final,Date=as.POSIXct(Date))
as.Date(final$Date)
as.POSIXct(unclass(final$Date))
as.Date.factor(final$Date)
View(final)
str(final)
as.POSIXct(as.character(final$Date))
as.POSIXlt.factor(final$Date)
library(lubridate)
mdy(final$Date)
temp=mutate(final,date=mdy(final$Date))
View(temp)
temp=arrange(temp,desc(date))
View(temp)
qplot(date,Ranking,temp)
qplot(date,Ranking,data=temp)
qplot(date,Ranking,data=temp,col="blue")
qplot(date,Ranking,data=temp,color="blue")
qplot(date,Ranking,data=temp,geom=c("smooth"))
qplot(date,Ranking,data=temp,geom=c("point","smooth"))
for(i=1:10){
sample(1:2,size=1,replace=TRUE)
}
for(i in 1:10){
sample(1:2,size=1,replace=TRUE)
}
outcomes = c("heads", "tails")
for(i in 1:10){
sample(outcomes,size=1,replace=TRUE)
}
table <- read.csv("~/Desktop/table.csv")
View(table)
library(dplyr)
table=mutate(table,change=Close-Open)%>%mutate(change=ifelse(change>0,'Up','Down'))
View(table)
last=table$change[1:247]
today=table$change[2:248]
date=table$Date
date=table$Date[1:247]
final=data.frame(date,last,today)
View(final)
barplot(table(final$last))
barplot(table(final$today))
barplot(table(final$last))
barplot(table(final$last),title="PLot of the last variable")
barplot(table(final$last),main = "PLot of the last variable")
barplot(table(final$last),main = "Plot of the last variable")
barplot(table(final$today),main = "Plot of the today variable")
table(final$last)
table(today$last)
table(final$today)
table(final$today)
table(final$today,final$last)
table(final$today,final$last,dnn = c("today","last"))
table(final$today,dnn = c("today"))
write.csv(final[1:20,c(2,3)],"data.csv",row.names=F)
temp=final[1:20,c(2,3)]
View(temp)
80.88+0.1058*199
2737.77*0.31+1584.9*0.405-804.63
0.297*2913.60+0.370*1514.3-837
teamRank = c(1,2,3,3,4,4,4,4,5,5)
a2012=c(94,88,95,88,,93,94,98,97,,93,94)
a2012=c(94,88,95,88,93,94,98,97,93,94)
a2013=c(97,97,92,93,,92,96,94,96,92,90)
a2013=c(97,97,92,93,92,96,94,96,92,90)
cor(teamRank,a2012)
cor(teamRank,a2013)
play <- read.csv("~/Downloads/play.csv")
View(play)
library(dplyr)
final=select(play,US.Downloads,Search.Rank)
View(final)
colnames(final)=c("downloads","rank")
View(final)
final=select(play,Date,US.Downloads,Search.Rank)
colnames(final)=c("date",downloads","rank")
colnames(final)=c("date","downloads","rank")
View(final)
seq(0,85)
rep(0,85)
sequence=rep(0,85)
for (i in 5:85){
sequence[i]=mean(final$downloads[i:i+5])
}
final$seq=sequence
View(final)
final1=final[-c(1,2,3,4,81,82,83,84,85)]
View(final1)
final1=final[-c(1,2,3,4,81,82,83,84,85),]
View(final1)
row.names(final1)=NULL
View(final1)
model=lm(rank~downloads+seq,data=final1)
summary(model)
model=lm(rank~seq,data=final1)
summary(model)
model=lm(rank~downloads,data=final1)
summary(model)
qplot(downloads,rank,,data=final1,geom=c("point","smooth"))
library(ggpot2)
library(ggpot2)
library(ggplot2)
qplot(downloads,rank,,data=final1,geom=c("point","smooth"))
cor(final1$rank,final1$downloads)
cor(final1$rank,final1$seq)
qplot(seq,rank,data=final1,geom=c("point","smooth"))
qplot(downloads,rank,,data=final1,geom=c("point","smooth"))
qplot(1/downloads,rank,,data=final1,geom=c("point","smooth"))
qplot(1/seq,rank,data=final1,geom=c("point","smooth"))
qplot(seq,rank,data=final1,geom=c("point","smooth"))
qplot(seq,rank,data=final1,geom=c("point","smooth"))
qplot(downloads,rank,,data=final1,geom=c("point","smooth"))
final2=select(final1,downloads<100)
final2=filter(final1,downloads<100)
View(final2)
qplot(downloads,rank,,data=final2,geom=c("point","smooth"))
qplot(1/downloads,rank,,data=final2,geom=c("point","smooth"))
cor(1/final2$downloads,final2$rank)
rm(final1,final2)
canada <- read.csv("~/Downloads/canada.csv")
View(canada)
germany <- read.csv("~/Downloads/germany.csv")
View(germany)
us <- read.csv("~/Downloads/us.csv")
View(us)
us=na.omit(us)
View(us)
library(ludridate)
library(lubridate)
temp=c("us","canda","germany")
for (i in 1:3){
colnames(as.name(temp[i]))=c("date","rank")
assign(temp[i],mutate(as.name(temp[i]),date=ymd(date)))
}
colnames(as.name(temp[i]))=c("date","rank")
row.names(as.name(temp[i]))=NULL
colnames(as.name(temp[i]))=c("date","rank")
as.name(temp[i])
as.call(temp[i])
as.environment(temp[i])
get(temp[i])
row.names(get(temp[i]))=NULL
colnames(get(temp[i]))=c("a","b")
colnames(us)=c("date","rank")
colnames(canada)=c("date","rank")
colnames(germany)=c("date","rank")
us=mutate(us,date=ymd(date))
View(us)
rn(play,final)
rm(play,final)
rm(i,model,sequence)
us <- read.csv("~/Downloads/us.csv")
View(us)
colnames(us)=c("date","rank")
View(us)
View(us)
us <- read.csv("~/Downloads/us.csv")
View(us)
us=na.omit(us)
View(us)
colnames(us)=c("date","rank")
str(us)
us1=mutate(us,date=ymd_hms(date))
View(us1)
us1=mutate(us,date=ymd_hms(date))%>%mutate(date=ymd(date))
View(us1)
us1=mutate(us,date=ymd_hms(date))
View(us1)
germany1=mutate(germany,date=ymd_hms(date))
canada1=mutate(canada1,date=ymd_hms(date))
canada1=mutate(canada,date=ymd_hms(date))
View(canada1)
germany2=filter(germany1,date>'2014-10-02')
us2=filter(us1,date>'2014-10-02')
View(us2)
library("sqldf", lib.loc="/Library/Frameworks/R.framework/Versions/3.1/Resources/library")
sqldf("select rank,date(date) as dt from us2 group by dt ")
us3=sqldf("select rank,date(date) as dt from us2 group by dt ")
germany3=sqldf("select rank,date(date) as dt from germany2 group by dt ")
View(germany3)
View(canada1)
canada3=sqldf("select rank,date(date) as dt from canada1 group by dt ")
View(canada3)
View(germany3)
final=merge(canada3,germany3,by="dt")
View(final)
final=merge(final,us3,by="dt")
View(final)
colnames(final)=c("date","canada","germany","us")
View(final)
qplot(canada,germany,data=final)
qplot(canada,us,data=final)
qplot(germany,us,data=final)
qplot(germany,us,data=final,geom=c("point","smooth"))
qplot(germany,us,data=final,geom=c("point","line"))
qplot(germany,us,data=final,geom=c("point","smooth"))
qplot(germany,canada,data=final,geom=c("point","smooth"))
qplot(germany,us,data=final,geom=c("point","smooth"))
cor(final$canada,final$us)
cor(final$germany,final$us)
cor(final$germany,final$us,na.rm=T)
cor(final)
cor(final[,c(2,3,4)])
final1=na.omit(final)
cor(final1[,c(2,3,4)])
write.csv(final,"rank_variation_countries.csv",row.names=F)
qplot(germany,canada,data=final,geom=c("point","smooth"))
qplot(us,canada,data=final,geom=c("point","smooth"))
cor(final1[,c(2,3,4)])
f8=dbConnect(MySQL(),user="sudokuphp",password="successlist",host="192.168.1.123",dbname="f8sudokuquest")
query=dbSendQuery(f8,"select date(starttime) as dt,count(*) as total from user_info where date(starttime)>'2015-1-1' group by date(starttime)")
data=fetch(query,n=-1)
View(data)
library(ggplot2)
qplot(dt,total,data=data)
qplot(dt,total,data=data,geom=c("point","smooth"))
e^-1
exp(-1)
exp(-1)/(1-0.3678794)
quality <- read.csv("~/Documents/Analytics Edge/Week 3/quality.csv")
View(quality)
library("caTools", lib.loc="/Library/Frameworks/R.framework/Versions/3.1/Resources/library")
set.seed(88)
split=sample.split(quality$PoorCare,SplitRatio = 0.75)
qualityTrain=subset(quality,split==TRUE)
qualityTest=subset(quality,split==FALSE)
QualityLog = glm(PoorCare ~ OfficeVisits + Narcotics, data=qualityTrain, family=binomial)
QualityLog = glm(PoorCare ~ StartedOnCombination+ProviderCount, data=qualityTrain, family=binomial)
summary(QualityLog)
install.packages("ROCR")
library("ROCR", lib.loc="/Library/Frameworks/R.framework/Versions/3.1/Resources/library")
predictTrain=predict(QualityLog,qualityTrain)
ROCRpred=prediction(predictTrain,qualityTrain$PoorCare)
ROCRperf=performance(ROCRpred,"tpr","fpr")
plot(ROCRperf)
plot(ROCRperf,colorize=TRUE)
plot(ROCRperf,colorize=TRUE,print.cutoof.at=seq(0,1,0.1),text.adj=c(-0.2,1.7))
plot(ROCRperf,colorize=TRUE,print.cutoof.at=seq(0,1,0.1))
QualityLog = glm(PoorCare ~ OfficeVisits + Narcotics, data=qualityTrain, family=binomial)
predictTrain=predict(QualityLog,qualityTrain)
ROCRpred=prediction(predictTrain,qualityTrain$PoorCare)
auc = as.numeric(performance(ROCRpredTest, "auc")@y.values)
predictTest = predict(QualityLog, type="response", newdata=qualityTest)
ROCRpredTest = prediction(predictTest, qualityTest$PoorCare)
auc = as.numeric(performance(ROCRpredTest, "auc")@y.values)
auc
play <- read.csv("~/Downloads/play.csv")
View(play)
play$Date=NULL
View(play)
model=lm(Search.Rank~.,data=play)
summary(model)
str(play)
library("randomForest", lib.loc="/Library/Frameworks/R.framework/Versions/3.1/Resources/library")
rf.model=randomForest(Search.Rank~.,data=play)
rf=randomForest(Search.Rank~.,data=play,mtry=3,importance = T)
apply(apply(play,MARGIN = 2,FUN = is.na),2,sum)
play$Day.7=NULL
play$Day.14=NULL
play$Day.30=NULL
rf=randomForest(Search.Rank~.,data=play,mtry=3,importance = T)
varImpPlot(rf)
importance(rf)
View(play)
active_devices <- read.csv("~/Downloads/amazon/Sudoku Quest Free - Kindle Edition-Active Devices-2014-04-01-2015-03-31.csv")
View(active_devices)
revenue <- read.csv("~/Downloads/amazon/Sudoku Quest Free - Kindle Edition-ARPD and ARPPU for In-App Items-2014-04-01-2015-03-31.csv")
View(revenue)
retention <- read.csv("~/Downloads/amazon/Sudoku Quest Free - Kindle Edition-Daily Retention for New Devices-2014-04-01-2015-03-31.csv", stringsAsFactors=FALSE)
View(retention)
sessions <- read.csv("~/Downloads/amazon/Sudoku Quest Free - Kindle Edition-Total Sessions-2014-04-01-2015-03-31.csv", stringsAsFactors=FALSE)
View(sessions)
final=cbind(sessons,play,retention,revenue)
final=cbind(sessions,play,retention,revenue)
final=cbind(sessions,retention,revenue)
View(final)
final$Date=NULL
View(final)
final$Date=NULL
View(final)
active_devices <- read.csv("~/Downloads/Sudoku Quest Free - Kindle Edition-Active Devices-2014-04-01-2015-03-31.csv")
View(active_devices)
sticky_factor <- read.csv("~/Downloads/Sudoku Quest Free - Kindle Edition-Sticky Factor (DAD_MAD)-2014-04-01-2015-03-31.csv")
View(sticky_factor)
merge(final,active_devices,by = "Date")
final1=merge(final,active_devices,by = "Date")
final1=merge(final1,sticky_factor,by = "Date")
View(final1)
str(final1)
library(lubrudate)
library(lubridate)
mdy(final1$Date)
final1=final1[-366,]
View(final1)
mdy(final1$Date)
final2=mutate(final1,Date=mdy(Date))&>&arrange(desc(Date))
final2=mutate(final1,Date=mdy(Date))%>%arrange(desc(Date))
final2=mutate(final1,Date=mdy(Date))%>%arrange(desc(Date))
final2=mutate(final1,Date=mdy(Date))
library("dplyr", lib.loc="/Library/Frameworks/R.framework/Versions/3.1/Resources/library")
final2=mutate(final1,Date=mdy(Date))%>%arrange(desc(Date))
View(final2)
final2=mutate(final1,Date=mdy(Date))%>%arrange(asc(Date))
final2=mutate(final1,Date=mdy(Date))%>%arrange((Date))
View(final2)
rm(active_devices,retention,revenue,sessions)
rm(sticky_factor)
write.csv(final2,"amazon.csv",row.names=F)
load("~/Documents/Analytics Edge/Week 4/.RData")
setwd("~/Documents/Analytics Edge/Week 4")
rm(addict,au,dk,final,final1,final2,nk,nz,play,rank1,rank,rank2)
rm(temp,temp1,temp2,temp_venn)
rm(nl,retarget,user_gs,user_info)
prp(CARTmodel2)
library("rpart", lib.loc="/Library/Frameworks/R.framework/Versions/3.1/Resources/library")
library("rpart.plot", lib.loc="/Library/Frameworks/R.framework/Versions/3.1/Resources/library")
prp(CARTmodel2)
View(gerber)
rpart(voting~hawthrone+civicduty+neighbors+self+sex,data=gerber,cp=0)
rpart(voting~hawthorne+civicduty+neighbors+self+sex,data=gerber,cp=0)
CARTmodel3=rpart(voting~hawthorne+civicduty+neighbors+self+sex,data=gerber,cp=0)
prp(CARTmodel3)
CARTmodel3=rpart(voting~hawthorne+civicduty+neighbors+self+sex+control,data=gerber,cp=0)
prp(CARTmodel3)
lapply(gerber[,c(1,3,4,5,6,7,8)],FUN = as.factor)
gerber[,c(1,3,4,5,6,7,8)]=lapply(gerber[,c(1,3,4,5,6,7,8)],FUN = as.factor)
str(gerber)
CARTmodel3=rpart(voting~hawthorne+civicduty+neighbors+self+sex+control,data=gerber,cp=0)
prp(CARTmodel3)
CARTmodel3=rpart(voting~hawthorne+civicduty+neighbors+self+sex+control,data=gerber,cp=0)
prp(CARTmodel3)
gerber1 <- read.csv("~/Documents/Analytics Edge/Week 4/assignment/gerber.csv")
View(gerber1)
CARTmodel3=rpart(voting~hawthorne+civicduty+neighbors+self+sex+control,data=gerber1,cp=0)
prp(CARTmodel3)
names(CARTmodel3)
CARTmodel4=rpart(voting~control,data=gerber1,cp=0)
CARTmodel5=rpart(voting~control+sex,data=gerber1,cp=0)
prp(CARTmodel4)
abs(prp(CARTmodel4)-prp(CARTmodel5),digits=6)
control=predict(CARTmodel4,newdata = gerber1)
non_control=predict(CARTmodel5,newdata = gerber1)
abs(control-non_control,digits=6)
abs(control-non_control)
mean(abs(control-non_control),digits=6)
prp(CARTmodel5)
sq_rank <- read.csv("~/sq_rank.txt", header=FALSE)
View(sq_rank)
sq_rank$V4=1000*sq_rank$V2+*sq_rank$V3
sq_rank$V4=1000*sq_rank$V2+sq_rank$V3
View(sq_rank)
as.Date(sq_rank$V1)
str(sq_rank)
sq_rank <- read.csv("~/sq_rank.txt", header=FALSE, stringsAsFactors=FALSE)
View(sq_rank)
sq_rank$V4=1000*sq_rank$V2+sq_rank$V3
as.Date(sq_rank$V1)
str(sq_rank)
strsplit(sq_rank$V1[1],"")[c(2,3,4)]
strsplit(sq_rank$V1[1],"")
strsplit(sq_rank$V1[1]," ")
strsplit(sq_rank$V1[1]," ")[c(1,2,3)]
strsplit(sq_rank$V1[1]," ")
strsplit(sq_rank$V1[1]," ")[[1]][c(1,2,3)]
for i in seq_along(strsplit(sq_rank$V1[1]," ")){
for i = seq_along(strsplit(sq_rank$V1[1]," ")){
View(sq_rank)
sq_rank=sq_rank[-1:631,]
sq_rank=sq_rank[-(1:631),]
View(sq_rank)
8268/365
temp=rep(0,365)
temp=rep(0,365)
for (i=1:365){
temp[i]=sq_rank$V1[i*23]
}
temp=rep(0,365)
for (i in 1:365){
temp[i]=sq_rank$V1[i*23]
}
temp=rep(0,365)
for (i in 1:365){
temp[i]=sq_rank$V4[i*23]
}
length(temp)
amazon <- read.csv("~/Documents/R Directory/game design/amazon.csv", stringsAsFactors=FALSE)
View(amazon)
amazon$rank=temp
View(amazon)
rf=randomForest(rank~.-Date,mtry = 4,data=amazon,importance=TRUE)
amazon1=na.omit(amazon)
rf=randomForest(rank~.-Date,mtry = 4,data=amazon1,importance=TRUE)
importance(rf)
varImpPlot(rf)
View(amazon1)
write.csv(amazon1,"amazon1.csv",row.names=F)
load("~/Documents/Analytics Edge/Week 4/.RData")
rm(addict,amazon,amazon1,au,dk,final,nl,nz,rank,rank1,rank2,retarget,sq_rank,temp,temp1,temp2,temp_venn,total_user_installs)
rm(f8,filterCtrl,filterCtrl)
rm(user_gs,user_info)
rm(cols,current_user_installs,desktop,fitControl)
rm(model,ios,i,Cumulative.Rating)
rm(rfFit1,rfWithFilter,query)
